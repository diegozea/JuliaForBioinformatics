<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Multiple Sequence Alignments · JuliaForBioinformatics</title><link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/4.2.0/normalize.min.css" rel="stylesheet" type="text/css"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.2.0/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link href="../assets/documenter.css" rel="stylesheet" type="text/css"/></head><body><nav class="toc"><h1>JuliaForBioinformatics</h1><select id="version-selector" onChange="window.location.href=this.value" style="visibility: hidden"></select><form class="search" id="search-form" action="../search/"><input id="search-query" name="q" type="text" placeholder="Search docs"/></form><ul><li><a class="toctext" href="../">Home</a></li><li><span class="toctext">Introduction</span><ul><li><a class="toctext" href="../01_Introduction/">Introduction</a></li><li><a class="toctext" href="../02_DataStructures/">Data Structures</a></li><li><a class="toctext" href="../03_Files_Homework/">HOMEWORK: Working with Files</a></li></ul></li><li><span class="toctext">Advance</span><ul><li><a class="toctext" href="../04_HowJuliaWorks/">How Julia works?</a></li><li><a class="toctext" href="../05_DefiningTypes/">Defining your own types</a></li><li><a class="toctext" href="../06_Strings/">Working with Strings</a></li><li><a class="toctext" href="../07_Stats/">Statistics</a></li><li><a class="toctext" href="../08_Packages_Homework/">HOMEWORK: Packages</a></li></ul></li><li><span class="toctext">Bioinformatics</span><ul><li class="current"><a class="toctext" href>Multiple Sequence Alignments</a><ul class="internal"><li><a class="toctext" href="#MSA-statistics-and-plotting-1">MSA statistics and plotting</a></li></ul></li><li><a class="toctext" href="../10_Information/">Counting residues</a></li><li><a class="toctext" href="../11_PDB/">MSA and structures</a></li></ul></li><li><a class="toctext" href="../api/">API</a></li></ul></nav><article id="docs"><header><nav><ul><li>Bioinformatics</li><li><a href>Multiple Sequence Alignments</a></li></ul><a class="edit-page" href="https://github.com/diegozea/JuliaForBioinformatics/blob/master/src/Bioinformatics/09_MSA.jl"><span class="fa"></span> Edit on GitHub</a></nav><hr/><div id="topbar"><span>Multiple Sequence Alignments</span><a class="fa fa-bars" href="#"></a></div></header><h1><a class="nav-anchor" id="Multiple-Sequence-Alignments-1" href="#Multiple-Sequence-Alignments-1">Multiple Sequence Alignments</a></h1><p><a href="https://mybinder.org/v2/gh/diegozea/JuliaForBioinformatics/gh-pages?filepath=dev/notebooks/09_MSA.ipynb"><img src="https://mybinder.org/badge_logo.svg" alt/></a> <a href="https://nbviewer.jupyter.org/github/diegozea/JuliaForBioinformatics/blob/gh-pages/dev/notebooks/09_MSA.ipynb"><img src="https://img.shields.io/badge/show-nbviewer-579ACA.svg" alt/></a></p><p>For this example, we use the Multiple Sequence Alignment (MSA) of the catalytic domain from the <em>Cytosol aminopeptidase family</em>. We use the <code>downloadpfam</code> function of the MIToS&#39; Pfam module to get the annotated <a href="https://en.wikipedia.org/wiki/Stockholm_format">Stockholm</a> file from the <a href="pfam.xfam.org/">Pfam</a> database:</p><pre><code class="language-">using MIToS.Pfam
const pfam_file = downloadpfam(&quot;PF00883&quot;)</code></pre><p>The <code>read</code> function from MIToS&#39; MSA allows parsing multiple sequence alignments. The file format is indicated by the second argument. There is no need for decompressing the file before reading it:</p><pre><code class="language-">using MIToS.MSA
msa = read(pfam_file, Stockholm)</code></pre><p>Pfam alignments are generated using <a href="http://hmmer.org/">HMMER3</a> Hidden Markov Model (HMM) searches, have insertion columns (indicated by dots and lowercase letters):</p><pre><code class="language-">first_seq = sequencenames(msa)[1]</code></pre><p><strong>TIP:</strong> You can use <a href="https://bicycle1885.github.io/TranscodingStreams.jl/stable/">TranscodingStreams</a> to read compressed files. In particular, the <em>CodecZlib</em> package has the needed codecs for reading gzipped files. For example, the next cell is similar to using <code>zgrep</code> in Linux:</p><pre><code class="language-bash">zgrep ^A0A094YQ53_BACAO/182-489 PF00883.stockholm.gz</code></pre><pre><code class="language-">using CodecZlib

open(GzipDecompressorStream, pfam_file) do file
	for line in eachline(file)
		if startswith(line, first_seq)
			println(line)
		end
	end
end</code></pre><p><strong>TIP:</strong> If you are on Linux and you have zgrep installed, you can run it as an <a href="https://docs.julialang.org/en/v1/manual/running-external-programs/index.html">external command</a> and use interpolation:</p><pre><code class="language-julia">run(`zgrep ^$first_seq $pfam_file`)</code></pre><p>or using the <a href="https://docs.julialang.org/en/v1/stdlib/REPL/#The-different-prompt-modes-1">shell mode</a> of the Julia REPL:</p><pre><code class="language-julia">;zgrep ^$first_seq $pfam_file</code></pre><p>Insert columns are deleted by MIToS, therefore the first MSA column has the label <code>&quot;69&quot;</code> (column  number in the input file) instead of <code>&quot;1&quot;</code>:</p><pre><code class="language-">columnnames(msa)[1]</code></pre><p>If we want to keep track of residue numbers in each sequence, we need to read the file using the keyword arguments <code>generatemapping</code> and <code>useidcoordinates</code>:</p><pre><code class="language-">const mapped_msa = read(pfam_file,
						Stockholm,
						generatemapping=true,
						useidcoordinates=true)</code></pre><pre><code class="language-">getsequencemapping(mapped_msa, &quot;A0A094YQ53_BACAO/182-489&quot;)</code></pre><p>The mapping is stored in the MSA annotations and it is automatically updated when columns are deleted.</p><p>The <code>getannot...</code> functions return dictionaries with the MSA annotations</p><pre><code class="language-">getannotresidue(mapped_msa)</code></pre><p>Pfam has &quot;AS&quot; (active site) and &quot;pAS&quot; (predicted active site) annotations for some families. We use <code>filter</code> to get a dictionary with the experimentally annotated active site residues (indicated by <code>*</code>):</p><pre><code class="language-">active_sites = filter(pair -&gt; pair[1][2] == &quot;AS&quot;, getannotresidue(mapped_msa))</code></pre><h4><a class="nav-anchor" id="Exercise-I-1" href="#Exercise-I-1">Exercise I</a></h4><p>Which are the UniProt residue numbers of residues at the active site of AMPL_BOVIN/197-508?</p><p><strong>Hint:</strong> You can use the functions <code>getsequencemapping</code> and <code>zip</code>.</p><pre><code class="language-julia"># ...your solution...</code></pre><p>The answer is <a href="https://www.uniprot.org/uniprot/P00727">294 and 368</a>.</p><h2><a class="nav-anchor" id="MSA-statistics-and-plotting-1" href="#MSA-statistics-and-plotting-1">MSA statistics and plotting</a></h2><p><a href="http://docs.juliaplots.org/latest/">Plots.jl</a> is a nice library because it gives a single API for multiple plotting backends (packages):</p><ul><li><a href="https://github.com/jheinen/GR.jl">GR</a> is fast</li><li><a href="https://github.com/sglyon/PlotlyJS.jl">PlotlyJS</a> is interactive</li><li><a href="https://github.com/Evizero/UnicodePlots.jl">UnicodePlots</a> doesn&#39;t need a graphics environment</li><li><a href="https://github.com/JuliaTeX/PGFPlots.jl">PGFPlots</a> has LaTeX quality</li><li><a href="https://github.com/JuliaPy/PyPlot.jl">PyPlot</a> for pythonists</li></ul><pre><code class="language-">using Plots
gr() # choose the plotting backend</code></pre><p>Plots.jl allows to define <a href="docs.juliaplots.org/latest/recipes/">plot recipes</a> and MIToS uses them to define plots for common biological objects:</p><pre><code class="language-">plot(mapped_msa)</code></pre><p>Plots are also really useful to visualize MSA statistics:</p><pre><code class="language-">plotlyjs() # change to an interactive backend</code></pre><pre><code class="language-">gap_percentage = 100.0 .* gapfraction(mapped_msa, 1) # i.e. reduce dimension 1</code></pre><pre><code class="language-">x = names(gap_percentage, 2)</code></pre><pre><code class="language-">y = vec(gap_percentage)</code></pre><pre><code class="language-">plot(x, y, legend=false)
xlabel!(&quot;MSA column (input file)&quot;)
ylabel!(&quot;Gap percentage&quot;)</code></pre><p>Something you can easily calculate with MIToS is the percentage identity between all the sequences in a Multiple Sequence Alignment:</p><pre><code class="language-">percent_id = percentidentity(mapped_msa)</code></pre><h4><a class="nav-anchor" id="Exercise-1-1" href="#Exercise-1-1">Exercise 1</a></h4><p>What is the sequence that has the highest identity percentage with AMPL_BOVIN/197-508?</p><p><strong>Hint:</strong> Use <a href="https://github.com/davidavdav/NamedArrays.jl">NamedArrays</a> <code>Not</code> indexing and <code>names</code> and Julia&#39;s <code>findmax</code>:</p><pre><code class="language-julia">using NamedArrays

# ...your solution...</code></pre><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p><footer><hr/><a class="previous" href="../08_Packages_Homework/"><span class="direction">Previous</span><span class="title">HOMEWORK: Packages</span></a><a class="next" href="../10_Information/"><span class="direction">Next</span><span class="title">Counting residues</span></a></footer></article></body></html>
